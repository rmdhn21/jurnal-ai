<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Jurnal AI - Life Organizer</title>
    <meta name="description" content="Aplikasi journaling dengan AI yang membantu Anda berpikir lebih jernih">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#f59e0b">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Jurnal AI">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons for iOS -->
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512.png">
    <link rel="icon" type="image/svg+xml" href="icons/icon.svg">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- iOS Safe Area Styling -->
    <style>
        /* iOS Safe Area Support */
        body {
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
        }

        /* iOS Standalone Mode Status Bar Padding */
        @media all and (display-mode: standalone) {
            .header {
                padding-top: calc(var(--spacing-md) + env(safe-area-inset-top));
            }
        }
    </style>
</head>

<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-screen">
        <div class="login-container">
            <div class="login-logo">âœ¨</div>
            <h1>Jurnal AI</h1>
            <p class="login-subtitle">Life Organizer</p>

            <div id="login-form" class="login-form">
                <input type="text" id="login-username" class="input" placeholder="Username">
                <input type="password" id="login-password" class="input" placeholder="Password">
                <button id="login-btn" class="btn btn-primary btn-full">ğŸ” Login Lokal</button>
                <button id="show-register-btn" class="btn btn-secondary btn-full">ğŸ“ Buat Akun Baru</button>

                <div class="divider">
                    <span>atau</span>
                </div>

                <button id="cloud-login-btn" class="btn btn-cloud btn-full">â˜ï¸ Login Cloud (Sync)</button>
            </div>

            <div id="register-form" class="login-form hidden">
                <input type="text" id="register-username" class="input" placeholder="Username baru">
                <input type="password" id="register-password" class="input" placeholder="Password">
                <input type="password" id="register-password-confirm" class="input" placeholder="Konfirmasi Password">
                <button id="register-btn" class="btn btn-primary btn-full">âœ… Daftar</button>
                <button id="show-login-btn" class="btn btn-secondary btn-full">â† Kembali ke Login</button>
            </div>

            <!-- Cloud Login Form -->
            <div id="cloud-login-form" class="login-form hidden">
                <p class="cloud-login-text">
                    Login dengan email untuk sync data antar device
                </p>
                <input type="email" id="cloud-email" class="input" placeholder="Email">
                <input type="password" id="cloud-password" class="input" placeholder="Password">
                <button id="cloud-signin-btn" class="btn btn-cloud btn-full">â˜ï¸ Sign In</button>
                <button id="cloud-signup-btn" class="btn btn-secondary btn-full">ğŸ“ Sign Up</button>
                <button id="back-to-local-btn" class="btn btn-secondary btn-full">â† Login Lokal</button>
            </div>
        </div>
    </div>

    <div class="app hidden" id="main-app">
        <!-- Header -->
        <header class="header">
            <h1 class="logo">âœ¨ Jurnal AI</h1>

            <!-- Global Search -->
            <div class="global-search">
                <input type="text" id="global-search-input" placeholder="ğŸ” Cari jurnal, task, goals..."
                    class="search-input">
                <div id="search-results" class="search-results hidden"></div>
            </div>

            <!-- Sync Status Indicator -->
            <div id="sync-status-indicator" class="sync-indicator" title="Status Sync">
                <span id="sync-icon">âš«</span>
                <span id="sync-text">Offline</span>
            </div>

            <div class="header-actions">
                <button id="theme-toggle-btn" class="icon-btn" title="Ganti Tema">ğŸŒ™</button>
                <button id="logout-btn" class="icon-btn" title="Logout">ğŸšª</button>
                <button id="settings-btn" class="icon-btn" title="Settings">âš™ï¸</button>
            </div>
        </header>

        <!-- Navigation (6 Tabs) -->
        <nav class="nav">
            <button class="nav-btn active" data-screen="dashboard">ğŸ“Š Dashboard</button>
            <button class="nav-btn" data-screen="journal">ğŸ“ Jurnal</button>
            <button class="nav-btn" data-screen="planner">ğŸ“‹ Planner</button>
            <button class="nav-btn" data-screen="goals">ğŸ¯ Goals</button>
            <button class="nav-btn" data-screen="finance">ğŸ’° Keuangan</button>
            <button class="nav-btn" data-screen="habits">âœ… Habits</button>
            <button class="nav-btn" data-screen="islam">â˜ªï¸ Ibadah</button>
            <button class="nav-btn" data-screen="interview-prep">ğŸ“ Interview</button>
            <button class="nav-btn" data-screen="english-hse">ğŸ‡¬ğŸ‡§ English O&G</button>
            <button class="nav-btn" data-screen="news">ğŸ“° Berita</button>
        </nav>

        <!-- Main Content -->
        <main class="main">
            <!-- Screen 0: Dashboard -->
            <section id="dashboard-screen" class="screen active">
                <!-- Gamification Profile Card -->
                <div id="user-profile-card">
                    <!-- Injected by gamification.js -->
                </div>

                <!-- Overview Cards -->
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="dashboard-icon">ğŸ“</div>
                        <div class="dashboard-stat" id="stat-journals">0</div>
                        <div class="dashboard-label">Total Jurnal</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="dashboard-icon">âœ…</div>
                        <div class="dashboard-stat" id="stat-tasks">0/0</div>
                        <div class="dashboard-label">Task Selesai</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="dashboard-icon">ğŸ’°</div>
                        <div class="dashboard-stat" id="stat-balance">Rp 0</div>
                        <div class="dashboard-label">Saldo</div>
                    </div>
                    <div class="dashboard-card" id="streak-card">
                        <div class="dashboard-icon">ğŸ”¥</div>
                        <div class="dashboard-stat" id="current-streak">0</div>
                        <div class="dashboard-label">Best Streak</div>
                    </div>

                    <div class="dashboard-card" id="prayer-card">
                        <div class="prayer-card-header">
                            <div class="prayer-card-left">
                                <span class="prayer-card-icon">ğŸ•Œ</span>
                                <div>
                                    <div class="prayer-card-location" id="prayer-location">Jakarta</div>
                                    <div class="prayer-card-name" id="next-prayer-name">Subuh</div>
                                </div>
                            </div>
                            <div class="prayer-card-right">
                                <div class="prayer-card-time" id="next-prayer-time">--:--</div>
                                <div class="prayer-card-countdown" id="next-prayer-countdown">-00:00:00</div>
                            </div>
                        </div>
                        <div class="prayer-list-mini" id="prayer-list-mini">
                            <!-- Injected by JS -->
                            <div>Subuh<br>04:30</div>
                            <div>Dzuhur<br>12:00</div>
                            <div>Ashar<br>15:15</div>
                            <div>Maghrib<br>18:00</div>
                            <div>Isya<br>19:15</div>
                        </div>
                    </div>
                </div>




                <!-- Daily Discipline Motivation -->
                <div class="card mt-md" id="motivation-card">
                    <!-- Injected by JS -->
                    <p class="text-muted">Memuat motivasi...</p>
                </div>

                <!-- Daily AI Tutors -->
                <div class="card mt-md" id="ai-tutor-card" style="border-left: 4px solid var(--secondary);">
                    <div class="brain-header-row">
                        <h3>ğŸ“ Guru Privat AI</h3>
                        <span class="badge-ai" id="tutor-status-badge">Tersedia</span>
                    </div>
                    <p class="text-muted" style="font-size: 0.9rem; margin-top: 5px; margin-bottom: 12px;">Pilih 1 topik
                        mikro untuk dipelajari hari ini. Beri AI beberapa detik untuk menyusun modul pendek khusus
                        untukmu.</p>

                    <div class="tutor-actions" id="tutor-action-btn-group"
                        style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <button class="btn btn-primary" onclick="requestTutor('AI')" style="flex:1;"><span
                                class="btn-icon">ğŸ§ </span> Belajar AI</button>
                        <button class="btn btn-secondary" onclick="requestTutor('Fisika')" style="flex:1;"><span
                                class="btn-icon">âš›ï¸</span> Belajar Fisika</button>
                    </div>

                    <div id="tutor-content-area" class="hidden"
                        style="background: var(--surface-hover); padding: 15px; border-radius: 8px;">
                        <!-- Loading or Content goes here -->
                    </div>
                </div>

                <!-- Daily Brain Boost -->
                <div class="card mt-md" id="brain-boost-card">
                    <div class="brain-header-row">
                        <h3>ğŸ§  Brain Boost</h3>
                        <span class="badge-ai">Daily XP</span>
                    </div>

                    <div class="brain-tabs">
                        <button class="brain-tab active" id="tab-fact" onclick="switchTab('fact')">ğŸ’¡ Fakta</button>
                        <button class="brain-tab" id="tab-vocab" onclick="switchTab('vocab')">ğŸ‡¬ğŸ‡§ Vocab</button>
                        <button class="brain-tab" id="tab-math" onclick="switchTab('math')">ğŸ§® Math</button>
                        <button class="brain-tab" id="tab-logic" onclick="switchTab('logic')">ğŸ§© Logic</button>
                        <button class="brain-tab" id="tab-myth" onclick="switchTab('myth')">ğŸ•µï¸ Mitos</button>
                    </div>

                    <div id="brain-content" class="brain-content mt-sm">
                        <!-- Injected by JS -->
                        <p class="text-muted">Memuat data...</p>
                    </div>
                </div>

                <!-- Daily Hadith -->
                <div class="card mt-md hadith-card-container">
                    <h3>âœ¨ Hadits Harian</h3>
                    <div id="hadith-content" class="hadith-content">
                        <p class="text-muted">Memuat hadits...</p>
                    </div>
                </div>


                <!-- Global Daily Budget -->
                <div class="card mt-md" id="global-budget-card">
                    <div class="budget-card-header">
                        <h3>ğŸ“‰ Budget Harian</h3>
                        <span id="global-budget-text" class="text-muted">Rp 0 / Rp 0</span>
                    </div>
                    <div class="progress-bar">
                        <div id="global-budget-progress" class="progress-fill" style="width: 0%"></div>
                    </div>
                    <small class="text-muted budget-card-hint">
                        Pengeluaran hari ini dari semua wallet.
                    </small>
                </div>

                <!-- Today's Reminder -->
                <div class="card">
                    <h3>ğŸ”” Reminder Hari Ini</h3>
                    <div id="today-reminders" class="reminder-list">
                        <p class="text-muted">Tidak ada reminder hari ini</p>
                    </div>
                </div>

                <!-- Upcoming Schedule -->
                <div class="card">
                    <h3>ğŸ“… Jadwal Mendatang</h3>
                    <div id="upcoming-schedules" class="reminder-list">
                        <p class="text-muted">Tidak ada jadwal</p>
                    </div>
                </div>

                <!-- Mood History Chart -->
                <div class="card">
                    <h3>ğŸ­ Mood Minggu Ini</h3>
                    <div class="mood-chart-container">
                        <canvas id="mood-chart" height="150"></canvas>
                    </div>
                </div>

                <!-- Mood Calendar Section -->
                <div class="card calendar-card">
                    <div class="calendar-header">
                        <button id="prev-month-btn" class="icon-btn">â—€</button>
                        <h3 id="calendar-month-year"></h3>
                        <button id="next-month-btn" class="icon-btn">â–¶</button>
                        <button id="year-view-btn" class="btn btn-small btn-secondary" style="margin-left: auto;">ğŸ“…
                            Year</button>
                    </div>
                    <div class="calendar-days-header">
                        <span>Sen</span><span>Sel</span><span>Rab</span><span>Kam</span><span>Jum</span><span>Sab</span><span>Min</span>
                    </div>
                    <div id="mood-calendar-grid" class="calendar-grid">
                        <!-- Days generated by JS -->
                    </div>
                </div>

                <!-- Quick AI Insight -->
                <div class="card">
                    <h3>ğŸ§  Quick AI Insight</h3>
                    <div id="quick-insight" class="insight-box">
                        <p class="text-muted">Klik tombol di bawah untuk insight harian</p>
                    </div>
                    <button id="get-daily-insight-btn" class="btn btn-ai btn-full">âœ¨ Dapatkan Insight Harian</button>
                </div>
            </section>

            <!-- Screen 1: Journal Write -->
            <section id="journal-screen" class="screen">
                <!-- On This Day Widget -->
                <div class="card" id="on-this-day-card"
                    style="display: none; background: linear-gradient(135deg, var(--surface), var(--surface-hover)); border-left: 4px solid var(--primary);">
                    <div class="on-this-day-header"
                        style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                        <span style="font-weight: 600; font-size: 0.9rem; color: var(--primary);">
                            â³ Pada Hari Ini <span id="otd-year" style="opacity:0.8;">...</span>
                        </span>
                    </div>
                    <div id="otd-loading" class="loading-spinner" style="margin: 10px 0; width: 20px; height: 20px;">
                    </div>
                    <p id="otd-text" class="text-muted"
                        style="font-size: 0.9rem; margin-bottom: 5px; line-height: 1.4; display: none;"></p>
                    <a id="otd-link" href="#" target="_blank"
                        style="font-size: 0.8rem; color: var(--primary); text-decoration: none; display: none;">Baca
                        selengkapnya &rarr;</a>
                </div>

                <div class="card journal-card">
                    <h2>Apa yang ada di pikiranmu?</h2>

                    <!-- Mood Selector -->
                    <div class="mood-selector">
                        <label class="mood-label">Bagaimana perasaanmu hari ini?</label>
                        <div class="mood-options" id="mood-options">
                            <button type="button" class="mood-btn" data-mood="great" title="Sangat Baik">ğŸ˜„</button>
                            <button type="button" class="mood-btn" data-mood="good" title="Baik">ğŸ™‚</button>
                            <button type="button" class="mood-btn" data-mood="neutral" title="Biasa">ğŸ˜</button>
                            <button type="button" class="mood-btn" data-mood="bad" title="Kurang Baik">ğŸ˜”</button>
                            <button type="button" class="mood-btn" data-mood="terrible" title="Buruk">ğŸ˜¢</button>
                        </div>
                        <input type="hidden" id="journal-mood" value="">
                    </div>

                    <!-- Journal Templates -->
                    <div class="journal-templates-section mt-sm">
                        <label class="form-label">Gunakan Template:</label>
                        <div id="journal-templates-container" class="templates-scroll-container">
                            <!-- Template chips injected by JS -->
                        </div>
                    </div>

                    <!-- Tag Input -->
                    <div class="tag-input-container">
                        <div id="journal-tags" class="tag-list"></div>
                        <input type="text" id="tag-input" class="tag-input" placeholder="+ Tag (Tekan Enter)">
                    </div>

                    <textarea id="journal-input" class="journal-textarea"
                        placeholder="Tulis apa saja yang kamu pikirkan atau rasakan hari ini..."></textarea>
                    <div class="journal-actions">
                        <button id="mic-btn" class="icon-btn" title="Rekam Suara">ğŸ¤</button>
                        <span id="recording-status" class="text-muted hidden recording-status">Mendengarkan...</span>
                        <button id="template-btn" class="icon-btn template-btn-space"
                            title="Template Muhasabah">ğŸ“‹</button>
                        <span id="char-count" class="char-count">0 karakter</span>
                        <button id="ask-ai-btn" class="btn btn-primary">
                            <span class="btn-icon">ğŸ¤–</span>
                            Minta Respon AI
                        </button>
                    </div>
                </div>

                <!-- AI Response Section (hidden by default) -->
                <div id="ai-response-section" class="ai-response-section hidden">
                    <div class="card response-card">
                        <div class="response-header">
                            <h3>ğŸ’¬ Respon AI</h3>
                            <button id="close-response" class="icon-btn">âœ•</button>
                        </div>

                        <!-- Validation -->
                        <div class="response-block validation">
                            <div class="response-label">ğŸ’ Validasi</div>
                            <p id="ai-validation"></p>
                        </div>

                        <!-- Summary -->
                        <div class="response-block summary">
                            <div class="response-label">ğŸ“Œ Ringkasan</div>
                            <ul id="ai-summary"></ul>
                        </div>

                        <!-- Suggestions -->
                        <div class="response-block suggestions">
                            <div class="response-label">ğŸ’¡ Saran</div>
                            <div id="ai-suggestions"></div>
                        </div>

                        <!-- Closing Question -->
                        <div class="response-block closing">
                            <div class="response-label">â“ Pertanyaan</div>
                            <p id="ai-closing"></p>
                        </div>

                        <!-- Save Journal Button -->
                        <div class="response-actions">
                            <button id="save-journal-btn" class="btn btn-secondary">
                                ğŸ’¾ Simpan Jurnal
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Loading State -->
                <div id="ai-loading" class="loading-overlay hidden">
                    <div class="loading-spinner"></div>
                    <p>AI sedang berpikir...</p>
                </div>

                <!-- Journal History -->
                <div class="card history-card">
                    <h3>ğŸ“š Jurnal Terbaru</h3>
                    <div class="journal-filter-bar">
                        <div class="filter-label">Filter:</div>
                        <div id="active-filters" class="active-filters"></div>
                        <select id="mood-filter" class="filter-select">
                            <option value="all">Semua Mood</option>
                            <option value="great">ğŸ˜„ Sangat Baik</option>
                            <option value="good">ğŸ™‚ Baik</option>
                            <option value="neutral">ğŸ˜ Biasa</option>
                            <option value="bad">ğŸ˜” Kurang Baik</option>
                            <option value="terrible">ğŸ˜¢ Buruk</option>
                        </select>
                        <select id="tag-filter" class="filter-select">
                            <option value="all">Semua Tags</option>
                        </select>
                    </div>
                    <div id="journal-history"></div>
                </div>
            </section>

            <!-- Screen 2: Planner -->
            <section id="planner-screen" class="screen">
                <!-- Pomodoro Timer -->
                <div class="card pomodoro-card">
                    <div class="pomodoro-header">
                        <h2>â±ï¸ Pomodoro Timer</h2>
                        <span id="pomodoro-session" class="session-badge">Session 1</span>
                    </div>

                    <!-- Mode Selector -->
                    <div class="pomodoro-modes">
                        <button class="btn btn-small btn-primary mode-btn" data-mode="focus"
                            data-time="25">Fokus</button>
                        <button class="btn btn-small btn-secondary mode-btn" data-mode="barakah" data-time="90">ğŸŒ…
                            Barakah</button>
                        <button class="btn btn-small btn-secondary mode-btn" data-mode="qailulah" data-time="20">ğŸ’¤
                            Qailulah</button>
                    </div>
                    <div class="pomodoro-display">
                        <div class="timer-circle">
                            <span id="timer-minutes">25</span>
                            <span class="timer-separator">:</span>
                            <span id="timer-seconds">00</span>
                        </div>
                        <div id="timer-label" class="timer-label">Fokus</div>
                    </div>
                    <div class="pomodoro-controls">
                        <button id="timer-start" class="btn btn-primary">â–¶ï¸ Mulai</button>
                        <button id="timer-pause" class="btn btn-secondary" disabled>â¸ï¸ Pause</button>
                        <button id="timer-reset" class="btn btn-secondary">ğŸ”„ Reset</button>
                    </div>
                    <div class="pomodoro-stats">
                        <span>ğŸ… <span id="pomodoro-count">0</span> pomodoro hari ini</span>
                    </div>
                </div>

                <div class="card kanban-container-card">
                    <!-- Calendar View -->
                    <div class="calendar-view">
                        <div class="calendar-header">
                            <h3 id="calendar-month-year">Februari 2026</h3>
                            <div class="calendar-nav">
                                <button id="prev-month">â—€</button>
                                <button id="next-month">â–¶</button>
                            </div>
                        </div>
                        <div class="calendar-grid" id="calendar-grid">
                            <!-- Injected by JS -->
                        </div>
                        <div id="selected-date-events" class="selected-date-events" style="display: none;">
                            <h4 id="selected-date-label">Events</h4>
                            <ul id="selected-date-list" class="date-events-list">
                                <!-- Injected by JS -->
                            </ul>
                        </div>
                    </div>

                    <div class="kanban-header">
                        <h2>ğŸ“‹ Kanban Board</h2>
                        <div class="add-form-inline">
                            <input type="text" id="new-todo-input" placeholder="Tambah tugas..." class="input">
                            <button id="add-todo-btn" class="btn btn-primary">+</button>
                        </div>
                    </div>

                    <div id="kanban-board" class="kanban-board-grid">
                        <!-- To Do Column -->
                        <div class="kanban-column" data-status="todo">
                            <div class="kanban-column-header header-todo">
                                <h3>ğŸ“ Rencana</h3>
                            </div>
                            <div class="kanban-column-list" id="kanban-col-todo">
                                <!-- Injected by JS -->
                            </div>
                        </div>

                        <!-- Doing Column -->
                        <div class="kanban-column" data-status="doing">
                            <div class="kanban-column-header header-doing">
                                <h3>ğŸš§ Proses</h3>
                            </div>
                            <div class="kanban-column-list" id="kanban-col-doing">
                                <!-- Injected by JS -->
                            </div>
                        </div>

                        <!-- Done Column -->
                        <div class="kanban-column" data-status="done">
                            <div class="kanban-column-header header-done">
                                <h3>âœ… Selesai</h3>
                            </div>
                            <div class="kanban-column-list" id="kanban-col-done">
                                <!-- Injected by JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>ğŸ“… Jadwal</h2>
                    <div class="add-form">
                        <input type="text" id="new-schedule-title" placeholder="Nama kegiatan..." class="input">
                        <div class="form-row">
                            <input type="datetime-local" id="new-schedule-datetime" class="input">
                            <select id="new-schedule-priority" class="input">
                                <option value="allah">ğŸ”´ Allah (Ibadah)</option>
                                <option value="self">ğŸŸ¢ Diri (Istirahat/Belajar)</option>
                                <option value="others">ğŸ”µ Umat (Kerja/Sosial)</option>
                            </select>
                        </div>
                        <button id="add-schedule-btn" class="btn btn-primary">+ Tambah</button>
                    </div>
                    <div id="schedule-list" class="schedule-list"></div>
                </div>

                <!-- AI Analysis Button -->
                <button id="analyze-planner-btn" class="btn btn-ai btn-full">ğŸ§  Analisis AI - Produktivitas</button>
            </section>

            <!-- Screen 3.5: Goals -->
            <section id="goals-screen" class="screen">
                <!-- Goal Stats -->
                <div class="dashboard-grid goals-grid">
                    <div class="dashboard-card">
                        <div class="dashboard-icon">ğŸ¯</div>
                        <div class="dashboard-stat" id="stat-goals-active">0</div>
                        <div class="dashboard-label">Goals Aktif</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="dashboard-icon">âœ…</div>
                        <div class="dashboard-stat" id="stat-goals-completed">0</div>
                        <div class="dashboard-label">Tercapai</div>
                    </div>
                </div>

                <!-- Add New Goal -->
                <div class="card">
                    <h2>ğŸ¯ Tambah Goal Baru</h2>
                    <div class="goal-form">
                        <input type="text" id="goal-title" placeholder="Judul goal (misal: Lari 5km)" class="input">
                        <div class="form-row">
                            <select id="goal-type" class="input">
                                <option value="habit">ğŸ”„ Berbasis Habit</option>
                                <option value="count">ğŸ”¢ Target Angka</option>
                                <option value="deadline">ğŸ“… Target Deadline</option>
                            </select>
                        </div>
                        <div class="form-row" id="goal-target-row">
                            <input type="number" id="goal-target" placeholder="Target (misal: 30)" class="input">
                            <input type="text" id="goal-unit" placeholder="Satuan (misal: hari, km)" class="input">
                        </div>
                        <input type="date" id="goal-deadline" class="input">
                        <textarea id="goal-notes" class="input" placeholder="Catatan (opsional)" rows="2"></textarea>
                        <button id="add-goal-btn" class="btn btn-primary">+ Tambah Goal</button>
                    </div>
                </div>

                <!-- Active Goals -->
                <div class="card">
                    <h3>ğŸš€ Goals Aktif</h3>
                    <div id="active-goals-list" class="goals-list"></div>
                </div>

                <!-- Completed Goals -->
                <div class="card">
                    <h3>ğŸ† Goals Tercapai</h3>
                    <div id="completed-goals-list" class="goals-list"></div>
                </div>
            </section>

            <!-- Screen 4: Finance -->
            <section id="finance-screen" class="screen">
                <!-- Wallet Summary -->
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ’³ Dompet Saya</h3>
                        <button id="manage-wallets-btn" class="btn btn-small btn-secondary">âš™ï¸ Kelola</button>
                    </div>
                    <div id="wallet-list-summary" class="wallet-list-summary">
                        <!-- Wallets injected here -->
                    </div>
                </div>

                <!-- Summary Cards -->
                <div class="summary-row">
                    <div class="summary-card income">
                        <span class="summary-label">Pemasukan</span>
                        <span id="total-income" class="summary-value">Rp 0</span>
                    </div>
                    <div class="summary-card expense">
                        <span class="summary-label">Pengeluaran</span>
                        <span id="total-expense" class="summary-value">Rp 0</span>
                    </div>
                    <div class="summary-card balance">
                        <span class="summary-label">Saldo Total</span>
                        <span id="total-balance" class="summary-value">Rp 0</span>
                    </div>
                </div>

                <!-- Chart -->
                <div class="card">
                    <h3>ğŸ“Š Grafik Bulanan</h3>
                    <div class="chart-container">
                        <canvas id="finance-chart"></canvas>
                    </div>
                </div>

                <!-- Global Budget Card -->
                <div id="global-budget-card" class="card hidden">
                    <div class="card-header">
                        <h3>ğŸ“‰ Budget Harian Global</h3>
                        <span id="global-budget-text" class="summary-value budget-font-sm">Rp 0 / Rp 0</span>
                    </div>
                    <div class="budget-progress-container budget-progress-mt">
                        <div id="global-budget-progress" class="budget-progress-bar" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Budget Card -->
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ“‰ Budgeting</h3>
                        <button id="manage-budget-btn" class="btn btn-small btn-secondary">âš™ï¸ Atur</button>
                    </div>
                    <div id="budget-list-summary" class="budget-list">
                        <!-- Budgets injected here -->
                    </div>
                </div>

                <!-- Add Transaction -->
                <div class="card">
                    <h2>ğŸ’° Tambah Transaksi</h2>
                    <div class="transaction-form">
                        <div class="form-row">
                            <select id="transaction-type" class="input">
                                <option value="income">ğŸ’µ Pemasukan</option>
                                <option value="expense">ğŸ’¸ Pengeluaran</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Wallet</label>
                            <select id="transaction-wallet" class="input">
                                <!-- Options injected by JS -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="toggle-label">
                                <input type="checkbox" id="is-recurring-transaction">
                                <span>ğŸ”„ Transaksi Rutin Bulanan?</span>
                            </label>
                        </div>
                        <div id="recurring-date-group" class="form-group hidden">
                            <label>Tanggal Rutin (Setiap Bulan)</label>
                            <input type="number" id="recurring-date" class="input" min="1" max="31"
                                placeholder="Tanggal 1-31">
                        </div>
                        <div class="form-row">
                            <input type="number" id="transaction-amount" placeholder="Jumlah" class="input">
                            <input type="date" id="transaction-date" class="input">
                        </div>
                        <input type="text" id="transaction-category" placeholder="Kategori (misal: Gaji, Makan)"
                            class="input">

                        <input type="text" id="transaction-desc" placeholder="Deskripsi (opsional)" class="input">
                        <button id="add-transaction-btn" class="btn btn-primary">+ Tambah Transaksi</button>
                    </div>
                </div>

                <!-- Transaction List -->
                <div class="card">
                    <h3>ğŸ“œ Riwayat Transaksi</h3>
                    <div id="transaction-list" class="transaction-list"></div>
                </div>

                <!-- AI Analysis Button -->
                <button id="analyze-finance-btn" class="btn btn-ai btn-full">ğŸ§  Analisis AI - Keuangan</button>
            </section>

            <!-- Screen 4: Habits -->
            <section id="habits-screen" class="screen">
                <!-- Habit Progress Chart -->
                <div class="card">
                    <h3>ğŸ“ˆ Progress Mingguan</h3>
                    <div class="chart-container">
                        <canvas id="habits-chart"></canvas>
                    </div>
                </div>

                <!-- Add Habit -->
                <div class="card">
                    <h2>âœ… Tambah Habit</h2>
                    <div class="add-form">
                        <input type="text" id="new-habit-input" placeholder="Nama habit baru..." class="input">
                        <select id="habit-frequency" class="input">
                            <option value="daily">ğŸ“… Harian</option>
                            <option value="weekly">ğŸ“† Mingguan</option>
                            <option value="custom">ğŸ”„ Custom</option>
                        </select>
                        <div id="habit-freq-days" class="habit-freq-days hidden">
                            <label><input type="checkbox" value="1"> Sen</label>
                            <label><input type="checkbox" value="2"> Sel</label>
                            <label><input type="checkbox" value="3"> Rab</label>
                            <label><input type="checkbox" value="4"> Kam</label>
                            <label><input type="checkbox" value="5"> Jum</label>
                            <label><input type="checkbox" value="6"> Sab</label>
                            <label><input type="checkbox" value="0"> Min</label>
                        </div>
                        <div id="habit-freq-interval" class="hidden">
                            <label class="settings-hint">Setiap berapa hari?</label>
                            <input type="number" id="habit-interval-days" class="input" placeholder="3" min="2" max="30"
                                value="3">
                        </div>
                        <button id="add-habit-btn" class="btn btn-primary">+ Tambah</button>
                    </div>
                </div>

                <!-- Today's Habits -->
                <div class="card">
                    <h3>ğŸ“… Hari Ini (<span id="today-date"></span>)</h3>
                    <div id="habits-today" class="habits-list"></div>
                </div>

                <!-- All Habits -->
                <div class="card">
                    <h3>ğŸ¯ Semua Habit</h3>
                    <div id="habits-list" class="habits-list"></div>
                </div>

                <!-- AI Analysis Button -->
                <button id="analyze-habits-btn" class="btn btn-ai btn-full">ğŸ§  Analisis AI - Kebiasaan</button>
            </section>
            <!-- Screen 5: Interview Prep -->
            <section id="interview-prep-screen" class="screen">
                <div class="card" id="interview-content">
                    <!-- Content injected by interview-prep.js -->
                </div>
            </section>

            <!-- Screen 6: Islam Tracker -->
            <section id="islam-screen" class="screen">
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ•Œ Ibadah Hari Ini</h3>
                        <span id="islam-date-display" class="text-muted"></span>
                    </div>

                    <!-- Islamic Progress Chart & Motivation (Added) -->
                    <div class="mt-sm" style="margin-bottom: 20px;">

                        <!-- Calendar Controls -->
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding: 0 10px;">
                            <button id="islam-prev-month" class="btn"
                                style="padding: 4px 12px; min-width: auto; background: var(--bg-secondary); border: 1px solid var(--border);">&larr;</button>
                            <h4 id="islam-current-month-label"
                                style="margin: 0; font-size: 1.1rem; color: var(--text-primary); font-weight: 600;">
                                Bulan</h4>
                            <button id="islam-next-month" class="btn"
                                style="padding: 4px 12px; min-width: auto; background: var(--bg-secondary); border: 1px solid var(--border);">&rarr;</button>
                        </div>

                        <div class="yearly-grid-container" style="padding: 10px;">
                            <div class="yearly-grid" id="islam-yearly-grid">
                                <!-- Grid will be injected here by JS -->
                            </div>
                            <div
                                style="display: flex; justify-content: center; align-items: center; gap: 8px; margin-top: 15px; font-size: 0.8em; color: var(--text-muted);">
                                <span>Kurang</span>
                                <div class="grid-cell level-0" style="width: 12px; height: 12px; border-radius: 2px;">
                                </div>
                                <div class="grid-cell level-1" style="width: 12px; height: 12px; border-radius: 2px;">
                                </div>
                                <div class="grid-cell level-2" style="width: 12px; height: 12px; border-radius: 2px;">
                                </div>
                                <div class="grid-cell level-3" style="width: 12px; height: 12px; border-radius: 2px;">
                                </div>
                                <div class="grid-cell level-4" style="width: 12px; height: 12px; border-radius: 2px;">
                                </div>
                                <span>Sempurna</span>
                            </div>
                        </div>
                        <div class="islam-motivation-box mt-sm"
                            style="background: rgba(var(--primary-rgb), 0.1); border-left: 4px solid var(--primary); padding: 12px; border-radius: 4px;">
                            <p id="islam-motivation-text"
                                style="font-size: 0.95em; color: var(--text-color); margin: 0; line-height: 1.4;">
                                <em>"Maka nikmat Tuhanmu yang manakah yang kamu dustakan?" - Memuat inspirasi...</em>
                            </p>
                        </div>
                    </div>

                    <!-- Wajib: Sholat 5 Waktu -->
                    <div class="mt-sm">
                        <label class="form-label" style="font-weight: 600;">Sholat Wajib</label>
                        <div class="prayer-checkbox-row"
                            style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                            <label class="btn btn-secondary btn-small"
                                style="display: flex; gap: 6px; align-items: center; padding: 6px 12px; border-radius: 20px;"><input
                                    type="checkbox" id="prayer-subuh" class="islam-checkbox"> <span>Subuh</span></label>
                            <label class="btn btn-secondary btn-small"
                                style="display: flex; gap: 6px; align-items: center; padding: 6px 12px; border-radius: 20px;"><input
                                    type="checkbox" id="prayer-dzuhur" class="islam-checkbox">
                                <span>Dzuhur</span></label>
                            <label class="btn btn-secondary btn-small"
                                style="display: flex; gap: 6px; align-items: center; padding: 6px 12px; border-radius: 20px;"><input
                                    type="checkbox" id="prayer-ashar" class="islam-checkbox"> <span>Ashar</span></label>
                            <label class="btn btn-secondary btn-small"
                                style="display: flex; gap: 6px; align-items: center; padding: 6px 12px; border-radius: 20px;"><input
                                    type="checkbox" id="prayer-maghrib" class="islam-checkbox">
                                <span>Maghrib</span></label>
                            <label class="btn btn-secondary btn-small"
                                style="display: flex; gap: 6px; align-items: center; padding: 6px 12px; border-radius: 20px;"><input
                                    type="checkbox" id="prayer-isya" class="islam-checkbox"> <span>Isya</span></label>
                        </div>
                    </div>

                    <hr class="settings-divider" style="margin: 16px 0;">

                    <!-- Sunnah Pagi -->
                    <div>
                        <label class="form-label" style="font-weight: 600;">Rutinitas Subuh & Istimewa</label>
                        <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
                            <label
                                style="display: flex; align-items: center; gap: 10px; font-size: 1.05em; cursor: pointer;">
                                <input type="checkbox" id="islam-qobliyah" class="islam-checkbox"
                                    style="width: 20px; height: 20px; accent-color: var(--primary);">
                                <span>Sholat Sunnah Qobliyah Subuh</span>
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 10px; font-size: 1.05em; cursor: pointer;">
                                <input type="checkbox" id="islam-sedekah" class="islam-checkbox"
                                    style="width: 20px; height: 20px; accent-color: var(--primary);">
                                <span>Sedekah Subuh</span>
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 10px; font-size: 1.05em; cursor: pointer;">
                                <input type="checkbox" id="islam-waqiah" class="islam-checkbox"
                                    style="width: 20px; height: 20px; accent-color: var(--primary);">
                                <span>Membaca / Mendengar Surah Al-Waqi'ah</span>
                            </label>
                        </div>
                    </div>

                    <hr class="settings-divider" style="margin: 16px 0;">

                    <!-- Qur'an & Puasa -->
                    <div>
                        <label class="form-label" style="font-weight: 600;">Amalan Lainnya</label>
                        <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
                            <label
                                style="display: flex; align-items: center; gap: 10px; font-size: 1.05em; cursor: pointer;">
                                <input type="checkbox" id="islam-fasting" class="islam-checkbox"
                                    style="width: 20px; height: 20px; accent-color: var(--primary);">
                                <span>Puasa (Sunnah / Wajib) Hari Ini</span>
                            </label>
                        </div>
                        <div class="form-group mt-sm">
                            <label class="form-label" style="font-size: 0.9em;">Bacaan Al-Quran Biasa
                                (Target/Capaian)</label>
                            <input type="text" id="islam-quran-text" class="input" placeholder="Misal: Al-Baqarah 1-10">
                        </div>
                    </div>

                    <hr class="settings-divider" style="margin: 16px 0;">

                    <!-- Dhikr Counter -->
                    <div class="mt-md" style="text-align: center;">
                        <label class="form-label" style="font-weight: 600;">Tasbih Digital</label>
                        <div style="display: flex; flex-direction: column; align-items: center; margin-top: 10px;">
                            <div
                                style="font-size: 4rem; font-weight: bold; color: var(--primary); background: var(--bg-color); border-radius: 20px; width: 150px; height: 100px; display: flex; align-items: center; justify-content: center; box-shadow: inset 0px 4px 6px rgba(0,0,0,0.1);">
                                <span id="dhikr-count">0</span>
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 15px;">
                                <button id="dhikr-reset-btn" class="btn btn-secondary"
                                    style="border-radius: 50%; width: 50px; height: 50px; padding: 0;"
                                    title="Reset">ğŸ”„</button>
                                <button id="dhikr-add-btn" class="btn btn-primary"
                                    style="border-radius: 50%; width: 100px; height: 100px; font-size: 2rem;">+1</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Analysis Button -->
                <button id="analyze-islam-btn" class="btn btn-ai btn-full mt-md">ğŸ§  Analisis AI - Ibadah</button>
                <div id="islam-ai-result" class="hidden mt-md"
                    style="background: var(--surface-hover); border-radius: 10px; padding: 15px; border-left: 4px solid var(--primary);">
                </div>
            </section>

            <!-- Screen 7: Realtime News / Berita (Added) -->
            <section id="news-screen" class="screen">
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ“° Berita Pasar & Kripto</h3>
                        <span id="news-last-updated" class="text-muted">Memuat...</span>
                    </div>

                    <!-- Category Tabs -->
                    <div class="news-category-tabs"
                        style="display: flex; gap: 10px; margin-top: 15px; margin-bottom: 20px;">
                        <button id="btn-news-crypto" class="btn btn-primary" style="flex: 1;">ğŸª™ Kripto</button>
                        <button id="btn-news-etf" class="btn btn-secondary" style="flex: 1;">ğŸ“ˆ Saham</button>
                        <button id="btn-news-ai" class="btn btn-secondary" style="flex: 1;">ğŸ¤– AI</button>
                    </div>

                    <!-- Loading Spinner -->
                    <div id="news-loading-spinner" style="text-align: center; padding: 20px; display: none;">
                        <div class="loading-spinner" style="display: inline-block; margin-bottom: 10px;"></div>
                        <p class="text-muted" style="margin: 0; font-size: 0.9em;">Mengambil artikel terbaru...</p>
                    </div>

                    <!-- News List Container -->
                    <div id="news-content-list" style="display: flex; flex-direction: column; gap: 15px;">
                        <!-- News cards injected by JS -->
                    </div>
                </div>
            </section>
        </main>

        <!-- AI Analysis Modal -->
        <div id="analysis-modal" class="modal hidden">
            <div class="modal-content card">
                <div class="modal-header">
                    <h3 id="analysis-title">ğŸ§  Analisis AI</h3>
                    <button id="close-analysis" class="icon-btn">âœ•</button>
                </div>
                <div id="analysis-loading" class="loading-section hidden">
                    <div class="loading-spinner"></div>
                    <p>AI sedang menganalisis...</p>
                </div>
                <div id="analysis-content" class="analysis-content"></div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal hidden">
            <div class="modal-content card">
                <div class="modal-header">
                    <h3>âš™ï¸ Pengaturan</h3>
                    <button id="close-settings" class="icon-btn">âœ•</button>
                </div>

                <!-- City Setting -->
                <div class="form-group">
                    <label>ğŸ“ Lokasi / Kota</label>
                    <small class="settings-hint">Untuk jadwal salat yang akurat.</small>
                    <div class="flex-row">
                        <input type="text" id="city-input" placeholder="Contoh: Jakarta, Bandung..."
                            class="input flex-1">
                        <button id="save-city-btn" class="btn btn-secondary">ğŸ’¾</button>
                    </div>
                </div>

                <hr class="settings-divider">

                <!-- API Key Section -->
                <div class="form-group">
                    <label for="api-key-input">ğŸ”‘ Gemini API Key</label>
                    <input type="password" id="api-key-input" class="input" placeholder="Masukkan API key...">
                    <small>Dapatkan gratis di <a href="https://aistudio.google.com/" target="_blank">Google AI
                            Studio</a></small>
                    <div class="api-key-warning">
                        <span class="warn-icon">âš ï¸</span>
                        <span>API key disimpan di browser (localStorage). Jangan gunakan di perangkat publik. Untuk
                            keamanan maksimal, gunakan server proxy.</span>
                    </div>
                </div>
                <button id="save-settings-btn" class="btn btn-primary">ğŸ’¾ Simpan API Key</button>

                <!-- App Lock Section -->
                <div class="form-group">
                    <label>ğŸ›¡ï¸ App Lock (PIN)</label>
                    <small class="settings-hint">Kunci aplikasi saat dibuka.</small>
                    <div class="reminder-settings">
                        <label class="toggle-label">
                            <input type="checkbox" id="pin-lock-toggle">
                            <span>Aktifkan PIN Lock</span>
                        </label>
                    </div>
                    <div id="pin-setup-section" class="hidden pin-setup-mt">
                        <button id="change-pin-btn" class="btn btn-secondary btn-full">Ubah PIN</button>
                    </div>
                </div>

                <hr class="settings-divider">



                <!-- Color Theme Section -->
                <div class="form-group">
                    <label>ğŸ¨ Tema Warna</label>
                    <small class="settings-hint">Pilih warna aksen aplikasi favoritmu.</small>
                    <div class="color-picker">
                        <button class="color-option" data-color="gold" style="background: #f59e0b;"
                            title="Emas (Default)"></button>
                        <button class="color-option" data-color="blue" style="background: #3b82f6;"
                            title="Biru Langit"></button>
                        <button class="color-option" data-color="green" style="background: #10b981;"
                            title="Hijau Segar"></button>
                        <button class="color-option" data-color="purple" style="background: #8b5cf6;"
                            title="Ungu Misterius"></button>
                        <button class="color-option" data-color="rose" style="background: #f43f5e;"
                            title="Merah Rose"></button>
                    </div>
                </div>
                <hr class="settings-divider">

                <!-- Security Section -->
                <div class="form-group">
                    <label>ğŸ”’ Enkripsi Data</label>
                    <small class="settings-hint">Enkripsi semua data dengan password. Data
                        tidak bisa dibaca tanpa password.</small>
                    <input type="password" id="encryption-password" class="input" placeholder="Password enkripsi...">
                    <div class="flex-row-sm mt-sm">
                        <button id="encrypt-data-btn" class="btn btn-secondary flex-1">ğŸ” Enkripsi</button>
                        <button id="decrypt-data-btn" class="btn btn-secondary flex-1">ğŸ”“ Dekripsi</button>
                    </div>
                    <div id="encryption-status" class="encryption-status"></div>
                </div>

                <!-- Global Finance Settings -->
                <div class="form-group">
                    <label>ğŸ’° Pengaturan Keuangan</label>
                    <small class="settings-hint">Atur batas pengeluaran harian global.</small>
                    <div class="flex-row">
                        <input type="number" id="global-daily-budget-input" placeholder="Batas Harian (Rp)"
                            class="input flex-1">
                        <button id="save-global-budget-btn" class="btn btn-secondary">ğŸ’¾</button>
                    </div>
                </div>

                <hr class="settings-divider">

                <hr class="settings-divider">

                <!-- Export Data (CSV) Section -->
                <div class="form-group">
                    <label>ğŸ“Š Export Data (Excel/CSV)</label>
                    <small class="settings-hint">Download data dalam format CSV untuk dibuka di
                        Excel.</small>
                    <div class="flex-row-wrap">
                        <button id="export-finance-csv-btn" class="btn btn-secondary flex-btn">ğŸ’° Keuangan</button>
                        <button id="export-journal-csv-btn" class="btn btn-secondary flex-btn">ğŸ“ Jurnal</button>
                        <button id="export-habits-csv-btn" class="btn btn-secondary flex-btn">ğŸ¯ Habits</button>
                    </div>
                </div>

                <!-- Backup Section -->
                <div class="form-group">
                    <label>ğŸ’¾ Backup & Restore</label>
                    <small class="settings-hint">Export data ke file JSON atau import dari
                        backup.</small>
                    <div class="flex-row-sm">
                        <button id="export-data-btn" class="btn btn-secondary flex-1">ğŸ“¤ Export Data</button>
                        <button id="import-data-btn" class="btn btn-secondary flex-1">ğŸ“¥ Import Data</button>
                    </div>
                    <input type="file" id="import-file-input" accept=".json" class="file-input-hidden">
                </div>
                <hr class="settings-divider">

                <!-- Reminder Settings -->
                <div class="form-group">
                    <label>ğŸ”” Pengaturan Reminder</label>
                    <small class="settings-hint">Aktifkan notifikasi untuk habits dan
                        jadwal.</small>
                    <div class="reminder-settings">
                        <label class="toggle-label">
                            <input type="checkbox" id="reminder-habits-toggle">
                            <span>Reminder Habits Harian</span>
                        </label>
                        <div id="habits-time-setting" class="sub-setting hidden">
                            <label>Jam reminder:</label>
                            <input type="time" id="habits-reminder-time" class="input" value="08:00">
                        </div>
                        <label class="toggle-label">
                            <input type="checkbox" id="reminder-schedule-toggle">
                            <span>Reminder Jadwal (15 menit sebelum)</span>
                        </label>
                    </div>
                    <button id="save-reminder-btn" class="btn btn-secondary btn-full mt-sm">ğŸ’¾
                        Simpan Reminder Settings</button>
                </div>

                <hr class="settings-divider">

                <!-- Danger Zone -->
                <div class="form-group">
                    <label class="danger-label">âš ï¸ Zona Bahaya</label>
                    <button id="clear-all-data-btn" class="btn btn-danger">ğŸ—‘ï¸
                        Hapus Semua Data</button>
                    <button id="delete-account-btn" class="btn btn-danger-strong">âŒ
                        Hapus Akun Cloud</button>
                    <small class="danger-hint">Hapus Akun akan menghapus akun
                        Supabase dan semua data cloud Anda.</small>
                </div>
            </div>
        </div>
        <!-- Wallet Management Modal -->
        <div id="wallet-modal" class="modal hidden">
            <div class="modal-content card">
                <div class="modal-header">
                    <h3>ğŸ’³ Kelola Dompet</h3>
                    <button id="close-wallet-modal" class="icon-btn">âœ•</button>
                </div>

                <div class="add-form">
                    <input type="text" id="new-wallet-name" placeholder="Nama Dompet (misal: Bank Jago)" class="input">
                    <input type="number" id="new-wallet-balance" placeholder="Saldo Awal" class="input" value="0">
                    <button id="add-wallet-btn" class="btn btn-primary">+ Tambah</button>
                </div>

                <div id="wallet-management-list" class="wallet-list">
                    <!-- List of wallets with delete buttons -->
                </div>
            </div>
        </div>

        <!-- Budget Management Modal -->
        <div id="budget-modal" class="modal hidden">
            <div class="modal-content card">
                <div class="modal-header">
                    <h3>ğŸ“‰ Atur Budget Bulanan</h3>
                    <button id="close-budget-modal" class="icon-btn">âœ•</button>
                </div>

                <div class="add-form">
                    <select id="new-budget-category" class="input">
                        <!-- Categories injected here -->
                    </select>
                    <input type="number" id="new-budget-limit" placeholder="Batas Budget Bulanan (Rp)" class="input">
                    <button id="add-budget-btn" class="btn btn-primary mt-sm">+ Set
                        Budget</button>
                </div>

                <div id="budget-management-list" class="budget-list mt-md">
                    <!-- List of budgets with delete buttons -->
                </div>
            </div>
        </div>

        <!-- Year in Pixels Modal -->
        <div id="year-in-pixels-modal" class="modal hidden">
            <div class="modal-content card wide-modal">
                <div class="modal-header">
                    <h3>ğŸ“… Year in Pixels</h3>
                    <button id="close-year-pixels" class="icon-btn">âœ•</button>
                </div>
                <!-- Calendar View -->
                <div class="calendar-container card">
                    <div class="calendar-header">
                        <h3 id="calendar-month-year">Februari 2026</h3>
                        <div class="calendar-nav">
                            <button id="prev-month" class="btn-icon">â®</button>
                            <button id="next-month" class="btn-icon">â¯</button>
                        </div>
                    </div>
                    <div class="calendar-grid" id="calendar-grid">
                        <!-- Calendar days will be generated here -->
                    </div>
                    <div id="selected-date-events" class="selected-date-events" style="display: none;">
                        <h4>Kegiatan pada <span id="selected-date-label"></span></h4>
                        <ul id="selected-date-list" class="date-events-list"></ul>
                    </div>
                </div>

                <div class="section-header">
                    <h3>Jadwal & Deadline</h3>
                    <button class="btn btn-primary btn-sm" id="add-schedule-btn">+ Jadwal</button>
                </div>
                <div class="year-pixels-controls">
                    <button id="prev-year-btn" class="icon-btn">â—€</button>
                    <span id="year-pixels-title">2026</span>
                    <button id="next-year-btn" class="icon-btn">â–¶</button>
                </div>
                <div class="year-pixels-container">
                    <div id="year-pixels-matrix" class="year-pixels-matrix">
                        <!-- Grid generated by JS -->
                    </div>
                </div>
                <div class="year-pixels-legend">
                    <div class="legend-item"><span class="dot mood-great"></span> Great</div>
                    <div class="legend-item"><span class="dot mood-good"></span> Good</div>
                    <div class="legend-item"><span class="dot mood-neutral"></span> Neutral</div>
                    <div class="legend-item"><span class="dot mood-bad"></span> Bad</div>
                    <div class="legend-item"><span class="dot mood-terrible"></span> Terrible</div>
                </div>
            </div>
        </div>

        <!-- Edit Modal -->
        <div id="edit-modal" class="modal hidden">
            <div class="modal-content card">
                <div class="modal-header">
                    <h3 id="edit-modal-title">Edit Item</h3>
                    <button id="close-edit-modal" class="icon-btn">âœ•</button>
                </div>
                <div id="edit-form-container" class="edit-form-container">
                    <!-- Form injected by JS -->
                </div>
                <div class="modal-actions mt-md">
                    <button id="save-edit-btn" class="btn btn-primary btn-full">ğŸ’¾ Simpan Perubahan</button>
                </div>
            </div>
        </div>

        <!-- Year in Pixels Modal -->
        <div id="year-in-pixels-modal" class="year-pixels-modal hidden">
            <div class="year-pixels-content">
                <div class="year-pixels-header">
                    <div class="btn-group">
                        <button id="prev-year-btn" class="icon-btn">â—€</button>
                        <h2 id="year-pixels-title">2026</h2>
                        <button id="next-year-btn" class="icon-btn">â–¶</button>
                    </div>
                    <button id="close-year-pixels" class="icon-btn">âœ•</button>
                </div>

                <div id="year-pixels-matrix" class="year-pixels-grid">
                    <!-- Injected by JS -->
                </div>

                <div class="year-pixels-legend">
                    <div class="legend-item">
                        <div class="legend-color mood-amazing"></div> Amazing
                    </div>
                    <div class="legend-item">
                        <div class="legend-color mood-good"></div> Good
                    </div>
                    <div class="legend-item">
                        <div class="legend-color mood-neutral"></div> Neutral
                    </div>
                    <div class="legend-item">
                        <div class="legend-color mood-bad"></div> Bad
                    </div>
                    <div class="legend-item">
                        <div class="legend-color mood-awful"></div> Awful
                    </div>
                </div>
            </div>
        </div>
        <!-- Lock Screen Overlay -->
        <div id="app-lock-screen" class="lock-screen hidden">
            <div class="lock-content">
                <div class="lock-icon">ğŸ”’</div>
                <h2 id="lock-title">Masukkan PIN</h2>
                <div class="pin-display">
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                </div>
                <div class="pin-keypad">
                    <button class="pin-btn" data-value="1">1</button>
                    <button class="pin-btn" data-value="2">2</button>
                    <button class="pin-btn" data-value="3">3</button>
                    <button class="pin-btn" data-value="4">4</button>
                    <button class="pin-btn" data-value="5">5</button>
                    <button class="pin-btn" data-value="6">6</button>
                    <button class="pin-btn" data-value="7">7</button>
                    <button class="pin-btn" data-value="8">8</button>
                    <button class="pin-btn" data-value="9">9</button>
                    <button class="pin-btn btn-clear" data-value="clear">C</button>
                    <button class="pin-btn" data-value="0">0</button>
                    <button class="pin-btn btn-back" data-value="back">âŒ«</button>
                </div>
            </div>
        </div>
        <!-- Screen 7: English HSE -->
        <section id="english-hse-screen" class="screen">
            <div class="card">
                <h2>ğŸ‡¬ğŸ‡§ English for Migas & HSE</h2>
                <p class="text-muted">Tingkatkan kefasihan Bahasa Inggris dan kosakata safety Anda.</p>
            </div>

            <!-- Daily Listening Case -->
            <div class="card mt-md" style="border-left: 4px solid var(--primary);">
                <h3>ğŸ§ Daily Listening Case</h3>
                <p class="text-muted" style="font-size: 0.9rem;">Dengarkan cerita insiden K3 pendek dan jawab
                    pertanyaannya. Latih pendengaran Anda!</p>
                <button id="generate-listening-btn" class="btn btn-ai btn-full mt-sm">ğŸ”„ Generate New Case</button>

                <div id="listening-case-area" class="mt-md hidden"
                    style="background: var(--surface-hover); padding: 15px; border-radius: 8px;">
                    <button id="play-listening-btn" class="btn btn-secondary"
                        style="display: block; width: 100%; font-size: 1.1rem; margin-bottom: 15px;">ğŸ”Š PLAY
                        AUDIO</button>

                    <button id="show-transcript-btn" class="btn btn-small"
                        style="background: transparent; color: var(--text-muted); text-decoration: underline; border: none; cursor: pointer; display: block; margin: 0 auto 15px;">Tampilkan
                        Teks (Transcript)</button>
                    <div id="listening-transcript" class="hidden"
                        style="font-style: italic; color: var(--text-color); margin-bottom: 20px; padding: 10px; background: var(--bg-color); border-radius: 4px; border-left: 3px solid var(--secondary); font-size: 0.9rem;">
                        <!-- Transcript injected here -->
                    </div>

                    <div id="listening-questions-area">
                        <!-- Questions injected here -->
                    </div>
                </div>
            </div>

            <!-- AI JSA & PTW Generator -->
            <div class="card mt-md" style="border-left: 4px solid var(--secondary);">
                <h3>ğŸ“‘ AI JSA & PTW Generator</h3>
                <p class="text-muted" style="font-size: 0.9rem;">Deskripsikan pekerjaan Anda, dan AI akan membuat draf
                    Job Safety Analysis / Permit to Work standar internasional dalam bahasa Inggris.</p>

                <div class="form-group mt-sm">
                    <label style="font-size: 0.9rem; font-weight: 500;">Tipe Dokumen</label>
                    <select id="jsa-doc-type" class="form-control"
                        style="width: 100%; padding: 10px; margin-top: 5px; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-color); color: var(--text-color);">
                        <option value="JSA">Job Safety Analysis (JSA)</option>
                        <option value="PTW">Permit to Work (PTW)</option>
                        <option value="JSA & PTW">Keduanya (JSA + PTW)</option>
                    </select>
                </div>

                <div class="form-group mt-sm">
                    <label style="font-size: 0.9rem; font-weight: 500;">Deskripsi Pekerjaan Singkat</label>
                    <textarea id="jsa-job-desc" class="form-control"
                        placeholder="Contoh: Pengelasan pipa di area terbatas (confined space), durasi 4 jam."
                        style="width: 100%; height: 80px; padding: 10px; margin-top: 5px; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-color); color: var(--text-color); resize: vertical;"></textarea>
                </div>

                <button id="generate-jsa-btn" class="btn btn-primary btn-full mt-sm">Mulai Generate Dokumen âš¡</button>

                <div id="jsa-result-area" class="mt-md hidden">
                    <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                        <button id="copy-jsa-btn" class="btn btn-secondary"
                            style="flex: 1; font-size: 0.85rem; padding: 8px;">ğŸ“‹ Copy Text</button>
                        <button id="translate-jsa-btn" class="btn btn-secondary"
                            style="flex: 1; font-size: 0.85rem; padding: 8px;">ğŸ‡®ğŸ‡© Terjemahkan</button>
                    </div>
                    <div id="jsa-content"
                        style="background: var(--bg-color); border: 1px solid var(--border); border-radius: 8px; padding: 15px; font-size: 0.9rem; overflow-x: auto;">
                        <!-- AI Table Content Injected Here -->
                    </div>
                </div>
            </div>

            <!-- Daily Vocab -->
            <div class="card mt-md" style="border-left: 4px solid var(--primary);">
                <h3>ğŸ“š Daily HSE Vocabulary</h3>
                <div id="hse-vocab-content">
                    <p class="text-muted">Loading vocabulary...</p>
                </div>
                <div class="flex-row mt-sm">
                    <button id="generate-vocab-btn" class="btn btn-secondary flex-1">ğŸ”„ Kosakata Lain</button>
                    <button id="save-vocab-btn" class="btn btn-primary flex-1 hidden">ğŸ’¾ Simpan ke Flashcard</button>
                </div>
            </div>

            <!-- Vocab Bank (Flashcards) -->
            <div class="card mt-md">
                <div class="card-header">
                    <h3>ğŸ—ƒï¸ Vocab Bank (Flashcards)</h3>
                    <span id="vocab-bank-count" class="badge-ai">0 Kata</span>
                </div>
                <p class="text-muted" style="font-size: 0.9rem; margin-bottom: 12px;">Koleksi kosakata yang Anda simpan
                    untuk dipelajari kembali.</p>
                <div id="vocab-bank-list"
                    style="display: grid; gap: 10px; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));">
                    <!-- Flashcard items injected by JS -->
                </div>
                <!-- Mini Quiz Button -->
                <button id="start-vocab-quiz-btn" class="btn btn-secondary mt-md hidden" style="width: 100%;">ğŸ§  Mulai
                    Review Kuis</button>
            </div>

            <!-- Quiz Modal Area -->
            <div id="vocab-quiz-area" class="mt-md hidden"
                style="background: var(--surface-hover); padding: 15px; border-radius: 8px; border: 1px solid var(--primary);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h4 style="margin: 0; color: var(--primary);">Quick Review</h4>
                    <span id="quiz-progress" style="font-size: 0.85rem; color: var(--text-muted);">1/5</span>
                </div>
                <div id="quiz-question"
                    style="font-size: 1.1rem; text-align: center; margin-bottom: 20px; font-weight: 500;">Apa bahasa
                    Inggris dari 'Sabuk Pengaman'?</div>
                <div id="quiz-options" style="display: flex; flex-direction: column; gap: 10px;">
                    <!-- Options injected by JS -->
                </div>
                <button id="close-quiz-btn" class="btn btn-danger mt-md" style="width: 100%;">Tutup Kuis</button>
            </div>

            <!-- Roleplay -->
            <div class="card mt-md">
                <h3>ğŸ—£ï¸ AI Roleplay Practice</h3>
                <p class="text-muted" style="font-size: 0.9rem;">Berlatih percakapan dengan peran Supervisor/Rekan
                    Kerja.</p>
                <div class="form-row mt-sm">
                    <select id="roleplay-scenario" class="input">
                        <option value="toolbox_talk">Toolbox Talk Briefing</option>
                        <option value="incident_report">Reporting an Incident</option>
                        <option value="ptw">Permit to Work (PTW) Request</option>
                        <option value="stop_work">Stop Work Authority Intervention</option>
                    </select>
                </div>
                <button id="start-roleplay-btn" class="btn btn-primary mt-sm">â–¶ï¸ Mulai Skenario</button>
                <button id="stop-roleplay-btn" class="btn btn-danger mt-sm hidden">ğŸ›‘ Hentikan</button>

                <div id="roleplay-chat-area" class="mt-md hidden"
                    style="background: var(--surface-hover); padding: 15px; border-radius: 8px;">
                    <div id="roleplay-chat-history"
                        style="max-height: 250px; overflow-y: auto; margin-bottom: 15px; display: flex; flex-direction: column; gap: 10px;">
                        <!-- Chat bubbles -->
                    </div>
                    <div class="flex-row">
                        <input type="text" id="roleplay-input" class="input flex-1" placeholder="Type your message...">
                        <button id="roleplay-mic-btn" class="btn btn-secondary"
                            title="Gunakan Suara (Speech-to-Text)">ğŸ™ï¸</button>
                        <button id="roleplay-send-btn" class="btn btn-primary">Send</button>
                    </div>
                </div>
            </div>

            <!-- Report Assistant -->
            <div class="card mt-md">
                <h3>ğŸ“ HSE Report Assistant</h3>
                <p class="text-muted" style="font-size: 0.9rem;">Masukkan draft laporan (boleh campur Bahasa Indonesia)
                    untuk diubah ke format HSE baku berbahasa Inggris.</p>
                <textarea id="hse-report-input" class="input mt-sm" rows="4"
                    placeholder="Contoh: Ada pekerja yang jatuh karena tidak pakai safety harness di scaffolding..."></textarea>
                <button id="translate-report-btn" class="btn btn-ai btn-full mt-sm">ğŸ§  Minta AI Perbaiki
                    Laporan</button>

                <div id="hse-report-result" class="mt-sm hidden"
                    style="background: var(--surface-hover); padding: 15px; border-radius: 8px; font-family: monospace; font-size: 0.95rem; white-space: pre-wrap;">
                </div>
            </div>
        </section>
    </div>

    <!-- Scripts (modular) -->
    <!-- Core / Data Layer -->
    <script src="js/storage.js"></script>
    <script src="js/cloud-sync.js"></script>
    <script src="js/ai.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/encryption.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/charts.js"></script>

    <!-- UI Modules -->
    <script src="js/backup-tags.js"></script>
    <script src="js/journal-ui.js"></script>
    <script src="js/planner-ui.js"></script>
    <script src="js/pomodoro.js"></script>
    <script src="js/finance-ui.js"></script>
    <script src="js/habits-goals-ui.js"></script>
    <script src="js/navigation-settings.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/wallet-budget-ui.js"></script>

    <!-- Feature Modules -->
    <script src="js/features.js"></script>
    <script src="js/extras.js"></script>
    <script src="js/edit-modal.js"></script>
    <script src="js/onboarding.js"></script>
    <script src="js/insight.js"></script>
    <script src="js/gamification.js"></script>
    <script src="js/hadith.js"></script>
    <script src="js/brain-boost.js"></script>
    <script src="js/journal-templates.js"></script>
    <script src="js/motivation.js"></script>
    <script src="js/interview-prep.js"></script>
    <script src="js/islam-tracker.js"></script>
    <script src="js/news-api.js"></script>
    <script src="js/ai-tutors.js"></script>
    <script src="js/english-hse.js"></script>

    <!-- App Initialization (must be last) -->
    <script src="js/app-init.js"></script>

    <!-- Register Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('SW registered:', registration);
                    })
                    .catch((error) => {
                        console.log('SW registration failed:', error);
                    });
            });
        }
    </script>
</body>

</html>